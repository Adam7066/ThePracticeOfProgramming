\documentclass[11pt, a4paper]{article}
\usepackage{fontspec}
\usepackage[CheckSingle, CJKmath]{xeCJK}
\usepackage[left=1cm, right=1cm, top=2.5cm, headheight=2.5cm]{geometry}
\usepackage{fancyhdr} % 頁首頁尾
\usepackage{lastpage} % 獲得總頁數
\usepackage{listings} % 顯示 code 用
\usepackage{color}
\usepackage[x11names]{xcolor}
\usepackage{multirow}
\usepackage{amssymb}

\setmainfont{Consolas}
\setmonofont{DroidSansMono Nerd Font}
\setCJKmainfont{Noto Sans CJK TC}
\setCJKmonofont{Noto Sans CJK TC}

\lstset{
    language=C++,
    basicstyle=\footnotesize\ttfamily,
    numbers=left,
    numberstyle=\footnotesize,
    stepnumber=1,
    numbersep=5pt,
    backgroundcolor=\color{white},
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    frame=false,
    tabsize=2,
    captionpos=b,
    breaklines=true,
    breakatwhitespace=false,
    escapeinside={\%*}{*)},
    morekeywords={*},
    keywordstyle=\bfseries\color{Blue1},
    commentstyle=\itshape\color{Red4},
    stringstyle=\itshape\color{Green4},
}

\pagestyle{fancy}
\fancyfoot{}
\fancyhead[C]{TPP2022-HW1-40947027S-余原齊}
\fancyhead[R]{\thepage/\pageref{LastPage}}

\begin{document}
    \begin{center}
        \renewcommand\arraystretch{1.5}
        \begin{tabular}{|l|l|}
            \hline
            查核規則&查核結果\\
            \hline
            \multirow{2}*{Avoid Long Functions \& Deep Nesting.}
                &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
            \cline{2-2}
                &$\square$ 已修改，簡要說明如下：\\
            \hline
            \multirow{3}*{Avoid Magic Numbers.}
                &$\square$ 第一版程式碼已遵守規則，未修改\\
            \cline{2-2}
                &$\blacksquare$ 已修改，簡要說明如下：\\
                &賦予地圖上特殊字元（例如:\#）名稱\\
            \hline
                \multirow{3}*{Declare Variables as Locally as Possible.}
                    &$\square$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\blacksquare$ 已修改，簡要說明如下：\\
                    &將 enum face 放進 robot class 中\\
            \hline
                \multirow{2}*{Minimize Global \& Shared Data.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Always Initialize Variables.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Avoid Macros.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Use const Proactively.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{\shortstack[l]{Take Parameters Appropriately by Value,\\Pointer, or Reference.}}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Hide Information.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Know When and How to Code for Scalability.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Don't Optimize Prematurely.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
                \multirow{2}*{Don't Pessimize Prematurely.}
                    &$\blacksquare$ 第一版程式碼已遵守規則，未修改\\
                \cline{2-2}
                    &$\square$ 已修改，簡要說明如下：\\
            \hline
        \end{tabular}
    \end{center}
    \newpage
    \begin{itemize}
        \item main.cpp
            \lstinputlisting{../code/main.cpp}
        \newpage
        \item maze.h
            \lstinputlisting{../code/maze.h}
        \item maze.cpp
            \lstinputlisting{../code/maze.cpp}
        \item robot.h
            \lstinputlisting{../code/robot.h}
        \newpage
        \item robot.cpp
            \lstinputlisting{../code/robot.cpp}
        \item makefile
            \lstinputlisting{../code/makefile}
    \end{itemize}
\end{document}